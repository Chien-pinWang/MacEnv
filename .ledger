
ledger='~/prj/ledger/Chien-pinWang.ledger'

alias lBal="ledger -f $ledger -B balance ^Assets ^Liabilities"
alias lNew="vi $ledger"
alias lCashBal="ledger -f $ledger balance 'SCSB Saving' Expenses:Cash"

function getPeriodBeginEnd() {
    period=$1
    case $period in
    "week")             # Last 7 days
        periodBegin=$(date -v-7d +%Y-%m-%d)
        periodEnd=$(date -v+1d +%Y-%m-%d)
        ;;
    "wtd")              # Week to date
        periodBegin=$(date -vsunday +%Y-%m-%d)
        periodEnd=$(date -v+1d +%Y-%m-%d)
        ;;
    "lastweek")         # Last week
        periodBegin=$(date -v-7d -vsunday +%Y-%m-%d)
        periodEnd=$(date -v-7d -vsaturday -v+1d +%Y-%m-%d)
        ;;
    "month")            # Last 30 days
        periodBegin=$(date -v-30d +%Y-%m-%d)
        periodEnd=$(date -v+1d +%Y-%m-%d)
        ;;
    "mtd")              # Month to date
        periodBegin=$(date +%Y-%m-01)
        periodEnd=$(date -v+1d +%Y-%m-%d)
        ;;
    "lastmonth")        # Last month
        periodBegin=$(date -v-1m -v1d +%Y-%m-%d)
        periodEnd=$(date -v1d +%Y-%m-%d)
        ;;
    *)                  # Today
        periodBegin=$(date +%Y-%m-%d)
        periodEnd=$(date -v+1d +%Y-%m-%d)
        ;;
    esac

    echo "$periodBegin $periodEnd"
}

function lCash () {
    periodRange=$(getPeriodBeginEnd "$1")
    # echo "Debug: $periodRange"
    periodB=${periodRange:0:10}
    periodE=${periodRange:11}
    ledger -f "$ledger" register Expenses:Cash -b "$periodB" -e "$periodE"
}

function lSCSB () {
    periodRange=$(getPeriodBeginEnd "$1")
    periodB=${periodRange:0:10}
    periodE=${periodRange:11}
    ledger -f "$ledger" register Liabilities:Card:SCSB -b "$periodB" -e "$periodE"
}

function lTSCB () {
    periodRange=$(getPeriodBeginEnd "$1")
    periodB=${periodRange:0:10}
    periodE=${periodRange:11}
    ledger -f "$ledger" register Liabilities:Card:TSCB -b "$periodB" -e "$periodE"
}

function lSaving () {
    periodRange=$(getPeriodBeginEnd "$1")
    periodB=${periodRange:0:10}
    periodE=${periodRange:11}
    ledger -f "$ledger" register "SCSB Saving" -b "$periodB" -e "$periodE"
}

function lExp () {
    periodRange=$(getPeriodBeginEnd "$1")
    periodB=${periodRange:0:10}
    periodE=${periodRange:11}
    ledger -f "$ledger" register Expenses and not Expenses:Cash -b "$periodB" -e "$periodE"
}
